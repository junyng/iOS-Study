# Best Practices for Working with Vertex Data

OpenGL ES를 사용하여 프레임을 렌더링하려면 앱에서 그래픽 파이프라인을 구성하고 그릴 그래픽 기본 요소를 제출하라. 일부 앱에서는 모든 기본 요소를 동일한 파이프라인 구성을 사용하여 그린다. 다른 앱은 다른 기법을 사용하여 프레임의 다른 요소를 렌더링할 수 있다. 그러나 앱에서 어떤 원시 요소를 사용하든, 파이프라인이 어떻게 구성되든, 앱은 OpenGL ES에 정점을 제공한다. 이 장에서는 정점 데이터에 대한 새로 고침을 제공하며 정점 데이터를 효율적으로 처리하는 방법에 대한 표적 조언을 따른다.

꼭지점은 위치, 색상, 정상 또는 텍스처 좌표와 같은 하나 이상의 속성으로 구성된다. OpenGL ES 2.0 또는 3.0 앱은 자체 속성을 자유롭게 정의할 수 있으며, 꼭지점 데이터의 각 속성은 꼭지점 셰이더의 입력 역할을 하는 속성 변수에 해당한다. OpenGL 1.1 앱은 고정 기능 파이프라인에 의해 정의된 속성을 사용한다.

속성을 1~4개의 _성분_으로 구성된 벡터로 정의하라. 속성의 모든 구성요소는 공통 데이터 유형을 공유한다. 예를 들어, 색상은 4개의 GLUBYTE 구성 요소\(빨간색, 녹색, 파란색, 알파\)로 정의될 수 있다. 속성이 셰이더 변수에 로드되면, 앱 데이터에 제공되지 않는 모든 구성요소는 OpenGL ES에 의해 기본값으로 채워진다. 마지막 구성요소는 그림 8-1과 같이 1로 채워지고, 기타 불특정 구성요소는 0으로 채워진다.

**Figure 8-1**  Conversion of attribute data to shader variables

![](../.gitbook/assets/interleaved_vertex_data_1_2x.png)

당신의 앱은 attribute를 상수로 구성할 수 있다. 즉, draw 명령의 일부로 제출되는 모든 정점에 동일한 값이 사용됨을 의미하며, 이는 각각의 정점들이 그 속성에 대한 값을 의미한다는 것을 의미한다. 앱이 OpenGL ES에서 정점 집합을 그리기 위해 함수를 호출하면 정점 데이터가 앱에서 그래픽 하드웨어로 복사된다. 정점 데이터에 작용하는 것보다 그래픽 하드웨어를 사용하여 셰이더에서 각 정점을 처리하고 원시 형상을 조립하여 프레임 버퍼로 레스터화한다. OpenGL ES의 한 가지 장점은 단일 기능 집합에서 정점 데이터를 OpenGL ES에 제출하도록 표준화하여 OpenGL이 제공하던 낡고 효율성이 떨어지는 메커니즘을 제거한다는 점이다.

프레임을 렌더링하기 위해 많은 수의 프리미티브를 제출해야 하는 앱은 정점 데이터를 신중하게 관리하고 OpenGL ES에 제공하는 방법을 관리해야 한다. 이 장에서 설명한 원리는 몇 가지 기본 원칙으로 요약할 수 있다:

* 정점 데이터의 크기를 줄여라.
* OpenGL ES가 정점 데이터를 그래픽 하드웨어로 전송하기 전에 반드시 발생해야 하는 전처리를 줄여라.
* 정점 데이터를 그래픽 하드웨어에 복사하는 데 소요되는 시간을 단축하라.
* 각 정점에 대해 수행된 계산을 줄여라.

### Simplify Your Models

iOS 기반 장치의 그래픽 하드웨어는 매우 강력하지만, 그것이 표시하는 이미지는 종종 매우 작다. iOS에서 매력적인 그래픽을 제시하기 위해 매우 복잡한 모델이 필요하지 않다. 모델을 직접 그리는 데 사용되는 정점 수를 줄이면 정점 데이터의 크기와 정점 데이터에 대해 수행된 계산이 감소한다.

다음과 같은 기법을 사용하여 모델의 복잡성을 줄일 수 있다:

* 여러 수준의 상세 수준에서 여러 버전의 모델을 제공하고 카메라에서 객체의 거리와 디스플레이의 치수에 따라 런타임에 적절한 모델을 선택한다.
* 텍스처를 사용하여 일부 정점 정보의 필요성을 제거합니다. 예를 들어, 범프 맵을 사용하여 더 많은 정점 데이터를 추가하지 않고 모델에 상세 정보를 추가할 수 있다.
* 일부 모델을 조명 세부 정보나 렌더링 품질을 개선하기 위해 정점을 추가한다. 이것은 일반적으로 각 정점에 대해 값을 계산하고 래스터화 단계에서 삼각형을 통해 보간할 때 수행된다. 예를 들어, 삼각형의 중심에서 스포트라이트를 지시하면 스포트라이트의 가장 밝은 부분이 정점을 향하지 않기 때문에 그 효과가 눈에 띄지 않을 수 있다. 정점을 추가하면 정점 데이터의 크기와 모델에서 수행된 계산을 늘리는 비용으로 보간점을 추가로 제공한다. 추가 정점을 추가하는 대신 파이프라인의 단편 단계로 계산을 이동하는 것을 고려하라.
  * 

