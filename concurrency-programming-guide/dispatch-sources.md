# Dispatch Sources

당신이 기본 시스템과 상호작용할 때마다, 당신은 반드시 그 태스크를 할 준비가 되어 있어야만 한다. 커널이나 다른 시스템 계층으로 호출하는 것은 자신의 프로세스 내에서 발생하는 호출에 비해 상당히 비싼 컨텍스트의 변화를 포함한다. 결과적으로, 많은 시스템 라이브러리는 당신의 코드가 시스템에 요청을 제출하고 그 요청이 처리되는 동안 다른 작업을 계속할 수 있도록 비동기 인터페이스를 제공한다. Grand Central Dispatch는 요청을 제출하고 블록 및 디스패치 큐를 사용하여 결과를 코드로 다시 보고할 수 있도록 함으로써 이러한 일반적인 행동을 기반으로 한다.

### 디스패치 소스에 대해

_dispatch source_는 특정 저수준 시스템의 이벤트 처리를 조정하는 기본 데이터 타입이다. Grand Central Dispatch는 다음과 같은 유형의 디스패치 소스를 지원한다:

* _Timer dispatch source_는 주기적인 노티피케이션을 생성한다.
* _Signal_ dispatch source는 UNIX 신호가 도착하면 알려준다.
* _Descriptor sources_는 다음과 같은 다양한 파일 및 소켓 기반 작업을 알려 준다:
  * 데이터를 읽을 수 있는 경우
  * 데이터를 쓸 수 있을 때
  * 파일 시스템에서 파일을 삭제, 이동 또는 이름을 변경한 경우
  * 파일 메타 정보가 변경될 때
* _Process dispatch source_는 다음과 같은 프로세스 관련 이벤트를 알려 준다:
  * 프로세스가 종료될 때
  * 프로세스가 `fork` 또는 `exec` 유형의 호출을 실행한 경우
  * 프로세스에 신호가 전달되는 경우
* _Mach port dispatch sources_에서 마하 관련 이벤트를 알린다.
* _Custom dispatch sources_는 사용자가 정의하고 트리거하는 소스이다.

디스패치 소스는 일반적으로 시스템 관련 이벤트를 처리하는 데 사용되는 비동기 콜백 함수를 대체한다. 디스패치 소스를 구성할 때 모니터링할 이벤트와 해당 이벤트를 처리하는 데 사용할 디스패치 큐 및 코드를 지정하라. 관심 이벤트가 도착하면, 디스패치 소스는 실행을 위해 당신의 블록이나 함수를 지정된 디스패치 큐에 제출한다.

큐에 수동으로 제출하는 태스크와 달리, 디스패치 소스는 애플리케이션에 대한 연속적인 이벤트 소스를 제공한다. 디스패치 소스는 명시적으로 취소할 때까지 디스패치 큐에 첨부되어 있다. 첨부하는 동안 해당 이벤트가 발생할 때마다 해당 태스크 코드를 디스패치 큐에 제출한다. 타이머 이벤트와 같은 일부 이벤트는 일정한 간격으로 발생하지만 대부분은 특정 조건이 발생할 때 산발적으로만 발생한다. 이러한 이유로, 디스패치 소스는 이벤트가 보류 중인 동안 조기에 릴리즈되지 않도록 디스패치 큐를 유지한다.

이벤트가 디스패치 큐에서 백로그되는 것을 방지하기 위해 디스패치 소스는 이벤트 병합 스킴을 구현한다. 이전 이벤트에 대한 이벤트 핸들러가 디큐잉되고 실행되기 전에 새로운 이벤트가 도착하면, 디스패치 소스는 새로운 이벤트 데이터의 데이터를 이전 이벤트의 데이터와 병합한다. 이벤트의 유형에 따라, 병합은 이전 이벤트를 대체하거나 보유하고 있는 정보를 업데이트할 수 있다. 예를 들어, 신호 기반 디스패치 소스는 가장 최근의 신호에 대한 정보만 제공하지만 이벤트 핸들러의 마지막 호출 이후 전달된 총 신호 수 또한 보고한다.

